<html>
	<head>
		<script type = "text/javascript" src = "vector.js"></script>
		<script type = "text/javascript" src = "graphics2D.js"></script>
		<script type = "text/javascript" src = "graphics3D.js"></script>
		<script text = "text/javascript" src = "light.js"></script>
		<script text = "text/javascript" src = "material.js"></script>
		<script text = "text/javascript" src = "matrix.js"></script>
		<script text = "text/javascript" src = "triangle3D.js"></script>	
		<script text = "text/javascript" src = "line3D.js"></script>
		<script text = "text/javascript" src = "ply.js"></script>
		<script>
			var canvas = null;
			var cxt = null;
			var g;
			var ply = new PLY("beethoven.ply");
			ply.load(50);
			window.addEventListener('load', onLoad);

			function onLoad(e){
				window.removeEventListener('load', onLoad);
				canvas = window.document.getElementById("can");
				cxt = canvas.getContext('2d');
				g = new Graphics3D(cxt);
				g.setCoordinates(true);
				
				// var g = new Graphics2D(cxt);
				// g.setColor("red");
				// g.setCoordinates(true);

				/*var cx = 0;
				var cy = 0;
				for (var t= 0; t < 2*Math.PI; t += 0.1) {
    					g.drawLine(cx, cy, cx + Math.cos(t)*50, cy + Math.sin(t)*50);
				}*/
					
				// g.fillTriangle(-100,-100,0,100,100,0);
								
								
				

				// setInterval(draw,33);
				// draw();

				// setInterval(draw2,33)
				// draw2();
				setInterval(draw3,33);
				// draw3();
				// setInterval(draw4,33);
				// draw4();
			}



			var x = 0;
			var y = 0;
			var x1 = 0;
			var z = 0;
			var sx = 0;
			var sy = 0;
			var sz = 0;
			var p = -495;
			

			var t = 7*Math.PI/6;
			var light1 = new Light({"diffusion":1,"specularity":1,"type": "point"});
			var light2 = new Light({"diffusion":0.5});
			function draw(){

				cxt.clearRect(0,0,500,500);
				cxt.fillStyle = "#000000"
				cxt.fillRect(0,0,500,500);

				light1.setPosition(1000*Math.cos(t/2),0,300);
				light1.setGelBySaturation({"r":0.7,"g":0.3});

				light2.setPosition(0,200,300);
				
				g.addLight(light1,true);
				g.addLight(light2);

				g.setSensor(0,200 + sy,1100);
				g.setFocalLength(500);
				
				g.setMaterial({"color": "#8080FF", "shine": 0}); //Blue middle
				g.fillPrism(0,0,0,300,100,100,t,0,t);

				g.setMaterial({"color": "#80FF80"}); //Green left
				g.fillPrism(-300,0,0,100,100,100,t,t,0);

				g.setMaterial({"color": "#FF8080"}); //Red Right
				g.fillPrism(300,0,0,100,100,100,0,t,t);
				g.draw({"lights":true, "ambience": false});
				t += 0.03;
				// sy-=5;
				
			}
			
			function draw2(){
				cxt.clearRect(0,0,500,500);
				cxt.fillStyle = "#000000"
				cxt.fillRect(0,0,500,500);
				cxt.fillStyle = "#FFFFFF"
				var thisFrame = new Date;
				cxt.fillText("FPS: " + Math.round(1000/(thisFrame - lastFrame)),10,20);
				lastFrame = thisFrame;

				g.setSensor(0,200 + sy,1100);
				g.setFocalLength(500);
				light1.setPosition(100,100,400);
				
				// g.drawGrid();
				g.addLight(light1,true);
				g.setMaterial({"color": [255,128,128], "specularExponent": 6, "specularMultiplier": 2});
				g.fillEllipsoid(0,0,0,100,100,50,sx,0,sx,8);
				g.draw({"lights":true,"ambience":false});
				sx+=0.03 
			}
			var lastFrame = new Date;
			function draw3(){

				
				cxt.clearRect(0,0,500,500);
				cxt.fillStyle = "#000000"
				cxt.fillRect(0,0,500,500);

				cxt.fillStyle = "#FFFFFF"
				var thisFrame = new Date;
				cxt.fillText("FPS: " + Math.round(1000/(thisFrame - lastFrame)),10,20);
				lastFrame = thisFrame;

				g.setSensor(0,200 + sy,1100);
				g.setFocalLength(500);
				light1.setPosition(200*Math.cos(10*sx),100,400);
				g.addLight(light1,true);
				g.shading = 'gouraud';
				// g.drawGrid();
				g.setMaterial({"color": [255,128,1], "specularExponent": 13, "specularMultiplier": 2, "diffusion": 1})
				// sx = Math.PI/6 + 0.27;
				ply.addTo(g,sx,sx,sx);
				g.draw({"lights":true,"ambience":false});

				sx += 0.03;
			}

			function draw4(){
				cxt.clearRect(0,0,500,500);
				var g = new Graphics2D(cxt);
				g.setCoordinates(true);
				g.setColor([255,0,0]);
				// g.interpolateTriangle(-200 + sx,0, 100,0, 0,100, 0,0,255, 255,0,0, 0,255,0)
				// g.interpolateTriangle(10*Math.cos(sx/10),0, 0,100*Math.sin(sx/10), 100*Math.sin(sx/10),0, 0,0,255, 255,0,0, 0,255,0)
				// g.fillTriangle(-200 + sx,0, 100,0, 0,100);
				g.draw();
				sx++;
			}
		</script>
	</head>
	<body>
		<canvas id = "can" width = "500" height = "500">
		</canvas>
	</body>
</html>
