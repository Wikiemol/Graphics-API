<html>
	<head>
		<script type = "text/javascript" src = "vector.js">
		</script>
		<script type = "text/javascript" src = "graphics2D.js">
		</script>
		<script type = "text/javascript" src = "graphics3D.js">
		</script>
		<script text = "text/javascript" src = "light.js"></script>
		<script text = "text/javascript" src = "material.js"></script>		
		<script>
			var canvas = null;
			var cxt = null;
			window.addEventListener('load', onLoad);
			function onLoad(e){
				
				canvas = window.document.getElementById("can");
				cxt = canvas.getContext('2d');
				
				// var g = new Graphics2D(cxt);
				// g.setColor("red");
				// g.setCoordinates(true);

				/*var cx = 0;
				var cy = 0;
				for (var t= 0; t < 2*Math.PI; t += 0.1) {
    					g.drawLine(cx, cy, cx + Math.cos(t)*50, cy + Math.sin(t)*50);
				}*/
					
				//g.fillTriangle(-10,-10,0,10,10,0);
				
								
				
				// setInterval(draw,33);
				setInterval(draw2,33);
				//draw2();
			}
			var y = 0;
			var x1 = 0;
			var z = 0;
			var sx = 0;
			var sy = 0;
			var sz = 0;
			var p = 0;
			function draw(){
				cxt.clearRect(0,0,500,500);
				var g = new Graphics3D(cxt);
				g.setSensor(150+sx,sy,1100 + sz);
				g.setFocalLength(600 - p);
				g.setCoordinates(true);
				g.setLightVector(-10+x,-10+y,-10+z);
				

				//g.setColor("#FFFF00");
				//g.fillTriangle(-100+x,0+y,50+z,-100+x,0+y,-50+z,0+x,100+y,0+z);

				//g.setColor("#0000FF");
				//g.fillTriangle(-100+x,0+y,50+z,100+x,0+y,50+z,0+x,100+y,0+z);
				
				//g.setColor("#AA0000");
				//g.fillTriangle(100+x,0+y,50+z,100+x,0+y,-50+z,0+x,100+y,0+z);

				//g.setColor("#AA00FF");
				//g.fillTriangle(-100+x,0+y,-50+z,100+x,0+y,-50+z,0+x,100+y,0+z);
				
				//g.setColor("#FF0000");
				//g.drawPrism(0,0,0,200,200,200);
				g.setMaterial(new Material("#443333"));
				g.fillPolygon([100,-100,100,100,100,100,100,100,-100,100,-100,-100,100,-100,100]);
				g.fillPolygon([-100,-100,-100,100,-100,-100,100,100,-100,-100,100,-100,-100,-100,-100]);
				g.fillPolygon([-100,-100,100,-100,-100,-100,-100,100,-100,-100,100,100,-100,-100,100]);
				g.fillPolygon([-100,-100,100,100,-100,100,100,-100,-100,-100,-100,-100,-100,-100,100]);
				g.draw();
				
				
				//p += 5;
				//sy--;
				x--;
				//sz -= 8
			}

			var t = 5;
			function draw2(){
				cxt.clearRect(0,0,500,500);
				var g = new Graphics3D(cxt);
				g.setSensor(0,200,1100);
				g.setFocalLength(600 - p);
				g.setCoordinates(true);
				// var l = new Light(10,10);
				// Square around origin.
				var x = new Array(4);
				var z = new Array(4);
				x[0] = -100; z[0] = -100;
				x[1] =  100; z[1] = -100;
				x[2] =  100; z[2] =  100;
				x[3] = -100; z[3] =  100;

				// Rotate square.
				for (var i = 0; i < 4; i++) {
					var newX = x[i]*Math.cos(t) - z[i]*Math.sin(t);
					var newZ = x[i]*Math.sin(t) + z[i]*Math.cos(t);
					x[i] = newX;
					z[i] = newZ;
				}

				var fillQuad = function (g, x1,y1,z1, x2,y2,z2, x3,y3,z3, x4,y4,z4) {
				    //g.fillTriangle(x1,y1,z1, x2,y2,z2, x3,y3,z3);
				    //g.fillTriangle(x1,y1,z1, x3,y3,z3, x4,y4,z4);
				    g.fillPolygon([x1,y1,z1,x2,y2,z2,x3,y3,z3,x4,y4,z4]);
				};

				// Draw cube.
				
				g.setMaterial(new Material("#808080"));
				// Bottom.
				fillQuad(g,
				    x[0], -100, z[0],
				    x[1], -100, z[1],
				    x[2], -100, z[2],
				    x[3], -100, z[3]);
				//g.draw();
				// Sides.
				
				var COLORS = ["#AA1111", "#11AA11", "#1111AA", "#AAAA11"];
				for (var i = 0; i < 4; i++) {
				    var x1 = x[i];
				    var z1 = z[i];
				    var x2 = x[(i + 1)%4];
				    var z2 = z[(i + 1)%4];
				    g.setMaterial(new Material(COLORS[i]));
				    fillQuad(g,
					x1, 100, z1,
					x2, 100, z2,
					x2, -100, z2,
					x1, -100, z1);
				}
				//g.draw();
				g.setMaterial(new Material("#808080"));
				// Top.
				fillQuad(g,
				    x[0], 100, z[0],
				    x[1], 100, z[1],
				    x[2], 100, z[2],
				    x[3], 100, z[3]);
				g.draw();
				
				
				t += 0.03;
				
			}
			
		</script>
	</head>
	<body>
		<canvas id = "can" width = "500" height = "500">
		</canvas>
	</body>
</html>
